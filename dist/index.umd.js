!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e||self).playerSdk={})}(this,function(e){function t(){return t=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e},t.apply(this,arguments)}function r(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){return{}}return e}var i=/*#__PURE__*/function(){function e(){this.map=new Map}var t=e.prototype;return t.getCallbacks=function(e){return this.map.get(e)||[]},t.removeCallback=function(e,t){var r=this.map.get(e)||[];if(r)if(t){var i=r.indexOf(t);-1!==i&&r.splice(i,1),0===r.length?this.map.delete(e):this.map.set(e,r)}else this.map.delete(e)},t.shiftCallback=function(e){var t=this.getCallbacks(e);if(0!==t.length){var r=t.shift();return this.removeCallback(e,r),r}},t.storeCallback=function(e,t){var r=this.map.get(e)||[];r.push(t),this.map.set(e,r)},e}();e.PlayerSdk=/*#__PURE__*/function(){function e(e){var t=this;this.iframe=void 0,this.callbackStore=void 0,this.guid=void 0,this.messageHandler=void 0,this.originUrl=void 0,this.origin="*",this.readyPromise=void 0,this.version=3,this.iframe=e,this.originUrl=new URL(this.iframe.src).origin,this.guid=crypto.randomUUID(),this.callbackStore=new i,this.readyPromise=new Promise(function(e){t.messageHandler=function(i){if(i.origin===t.originUrl){var n=r(i.data);if((null==n?void 0:n.version)===t.version&&("handshake"!==(null==n?void 0:n.action)||(null==n?void 0:n.guid)===t.guid))return"ready"===(null==n?void 0:n.action)||"handshake"===(null==n?void 0:n.action)?(t.origin=i.origin,void e()):void t.processData(n)}},window.addEventListener("message",t.messageHandler)}),this.postMessage({action:"handshake",guid:this.guid})}var n=e.prototype;return n.addEventListener=function(e,t){var r=this;if(!e)throw new TypeError("You must pass an event name.");if(!t)throw new TypeError("You must pass a callback function.");if("function"!=typeof t)throw new TypeError("The callback must be a function.");0===this.callbackStore.getCallbacks("event:"+e).length&&this.readyPromise.then(function(){r.postMessage({action:"event",guid:r.guid,name:e,value:"add"})}),this.callbackStore.storeCallback("event:"+e,t)},n.destroy=function(){this.messageHandler&&window.removeEventListener("message",this.messageHandler),this.postMessage({action:"command",guid:this.guid,name:"destroy"})},n.disableCaptionTrack=function(){this.enableCaptionTrack(null)},n.enableCaptionTrack=function(e){this.set("captionTrack",e)},n.getCaptionTracks=function(){try{return Promise.resolve(this.get("captionTracks"))}catch(e){return Promise.reject(e)}},n.getChapters=function(){try{return Promise.resolve(this.get("chapters"))}catch(e){return Promise.reject(e)}},n.getCurrentChapter=function(){try{return Promise.resolve(this.get("chapter"))}catch(e){return Promise.reject(e)}},n.getCurrentCaptionTrack=function(){try{return Promise.resolve(this.get("captionTrack"))}catch(e){return Promise.reject(e)}},n.getCurrentTime=function(){try{return Promise.resolve(this.get("currentTime"))}catch(e){return Promise.reject(e)}},n.getDuration=function(){try{return Promise.resolve(this.get("duration"))}catch(e){return Promise.reject(e)}},n.getLayout=function(){try{return Promise.resolve(this.get("layout"))}catch(e){return Promise.reject(e)}},n.getLiveEndTime=function(){try{return Promise.resolve(this.get("liveEndTime"))}catch(e){return Promise.reject(e)}},n.getLiveStartTime=function(){try{return Promise.resolve(this.get("liveStartTime"))}catch(e){return Promise.reject(e)}},n.getLiveState=function(){try{return Promise.resolve(this.get("liveState"))}catch(e){return Promise.reject(e)}},n.getPictureInPicturePosition=function(){try{return Promise.resolve(this.get("pipPosition"))}catch(e){return Promise.reject(e)}},n.getPlaybackRate=function(){try{return Promise.resolve(this.get("playbackRate"))}catch(e){return Promise.reject(e)}},n.getPlaybackRates=function(){try{return Promise.resolve(this.get("playbackRates"))}catch(e){return Promise.reject(e)}},n.getPresentation=function(){try{return Promise.resolve(this.get("presentation"))}catch(e){return Promise.reject(e)}},n.getPrimaryContent=function(){try{return Promise.resolve(this.get("primaryContent"))}catch(e){return Promise.reject(e)}},n.getSideBySideRatio=function(){try{return Promise.resolve(this.get("sideBySideRatio"))}catch(e){return Promise.reject(e)}},n.getVolume=function(){try{return Promise.resolve(this.get("volume"))}catch(e){return Promise.reject(e)}},n.isPaused=function(){try{return Promise.resolve(this.get("paused"))}catch(e){return Promise.reject(e)}},n.pause=function(){this.command("pause")},n.play=function(){this.command("play")},n.removeEventListener=function(e,t){if(!e)throw new TypeError("You must pass an event name.");this.callbackStore.removeCallback("event:"+e,t),0===this.callbackStore.getCallbacks("event:"+e).length&&this.postMessage({action:"event",guid:this.guid,name:e,value:"remove"})},n.setCurrentTime=function(e){if(e<0)throw new Error("The current time must be superior or equal to 0");this.set("currentTime",e)},n.setLayout=function(e){this.set("layout",e)},n.setPictureInPicturePosition=function(e){this.set("pipPosition",e)},n.setPlaybackRate=function(e){if(e<0)throw new Error("The playback rate must be superior or equal to 0");if(e>2)throw new Error("The playback rate must be inferior or equal to 2");this.set("playbackRate",e)},n.setPrimaryContent=function(e){this.set("primaryContent",e)},n.setSideBySideRatio=function(e){if(e<50||e>80)throw new Error("The ratio must be between 50 and 80");this.set("sideBySideRatio",e)},n.setVolume=function(e){if(e<0||e>100)throw new Error("The volume must be between 0 and 100");this.set("volume",e)},n.command=function(e,t){var r={action:"command",guid:this.guid,name:e};t&&(r.value=t),this.postMessage(r)},n.get=function(e){var t=this;return new Promise(function(r,i){try{var n=function(n,o){try{var s=Promise.resolve(t.readyPromise).then(function(){t.callbackStore.storeCallback("get:"+e,{reject:i,resolve:r}),t.postMessage({action:"get",guid:t.guid,name:e})})}catch(e){return o(e)}return s&&s.then?s.then(void 0,o):s}(0,function(e){i(e)});return Promise.resolve(n&&n.then?n.then(function(){}):void 0)}catch(e){return Promise.reject(e)}})},n.postMessage=function(e){var r,i=JSON.stringify(t({},e,{version:this.version}));null==(r=this.iframe.contentWindow)||r.postMessage(i,this.origin)},n.processData=function(e){var t=r(e),i=[];if((null==t?void 0:t.version)===this.version&&(null==t?void 0:t.guid)===this.guid){if("event"===t.action)i=this.callbackStore.getCallbacks(t.action+":"+t.name);else if("get"===t.action||"set"===t.action){var n=this.callbackStore.shiftCallback(t.action+":"+t.name);n&&i.push(n)}i.forEach(function(e){"function"==typeof e?e(t.value):e.resolve(t.value)})}},n.set=function(e,t){var r=this;if(void 0===t)throw new TypeError("A value must be set.");this.readyPromise.then(function(){r.postMessage({action:"set",guid:r.guid,name:e,value:t})})},e}()});
//# sourceMappingURL=index.umd.js.map
